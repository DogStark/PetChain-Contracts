warning: unused imports: `BytesN` and `Bytes`
 --> src\test.rs:6:9
  |
6 |         Bytes, BytesN, Env,
  |         ^^^^^  ^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: variable does not need to be mutable
   --> src\lib.rs:607:17
    |
607 |             let mut is_authorized_for_full_data = false;
    |                 ----^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |                 |
    |                 help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `current_user`
   --> src\lib.rs:606:17
    |
606 |             let current_user = env.current_contract_address()...
    |                 ^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_current_user`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `is_authorized_for_full_data`
   --> src\lib.rs:607:17
    |
607 |             let mut is_authorized_for_full_data = false;
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_is_authorized_for_full_data`

warning: unused variable: `vax_count`
    --> src\lib.rs:1173:13
     |
1173 |         let vax_count: u64 = env
     |             ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_vax_count`

warning: unused variable: `pet`
    --> src\lib.rs:1992:17
     |
1992 |             let pet = env
     |                 ^^^ help: if this is intentional, prefix it with an underscore: `_pet`

warning: `petchain-stellar` (lib test) generated 6 warnings (run `cargo fix --lib -p petchain-stellar --tests` to apply 6 suggestions)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.68s
     Running unittests src\lib.rs (target\debug\deps\petchain_stellar-7f9cdc727f1b5108.exe)

running 12 tests
test test::test::test_register_pet_owner ... ok
test test::test::test_set_and_get_emergency_contacts ... ok
test test::test::test_link_tag_to_pet ... ok
test test::test::test_pet_privacy_flow ... ok
test test::test::test_update_medical_record_nonexistent ... ok
test test::test::test_lab_results ... ok
test test::test::test_register_pet ... ok
test test::test::test_update_tag_message ... ok
test test::test::test_tag_id_uniqueness ... ok
test test::test::test_update_medical_record ... ok
test test::test::test_vaccination_history_overdue ... FAILED
test test::test::test_record_and_get_vaccination ... FAILED

failures:

---- test::test::test_vaccination_history_overdue stdout ----

thread 'test::test::test_vaccination_history_overdue' (36532) panicked at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:768:9:
HostError: Error(WasmVm, InvalidAction)

Event log (newest first):
   0: [Diagnostic Event] topics:[error, Error(WasmVm, InvalidAction)], data:"escalating error to panic"
   1: [Diagnostic Event] topics:[error, Error(WasmVm, InvalidAction)], data:["contract call failed", add_vaccination, [1, CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHK3M, [Rabies], "Old Rabies", 990000, 990000, "B1"]]
   2: [Failed Diagnostic Event (not emitted)] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:[error, Error(WasmVm, InvalidAction)], data:"caught error from function"
   3: [Failed Diagnostic Event (not emitted)] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:[log], data:["caught panic 'Veterinarian not verified' from contract function 'Symbol(obj#147)'", 1, CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHK3M, [Rabies], "Old Rabies", 990000, 990000, "B1"]
   4: [Diagnostic Event] topics:[fn_call, Bytes(0000000000000000000000000000000000000000000000000000000000000001), add_vaccination], data:[1, CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHK3M, [Rabies], "Old Rabies", 990000, 990000, "B1"]
   5: [Diagnostic Event] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:[fn_return, register_pet], data:1
   6: [Contract Event] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:["PetRegistered", 1], data:{name: "PROTECTED", owner: CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCT4, pet_id: 1, species: [Dog], timestamp: 0}
   7: [Diagnostic Event] topics:[fn_call, Bytes(0000000000000000000000000000000000000000000000000000000000000001), register_pet], data:[CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCT4, "Rex", "2019-01-01", [Male], [Dog], "Boxer", [Public]]

Backtrace (newest first):
   0: backtrace::backtrace::win64::trace
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\backtrace\win64.rs:85
      backtrace::backtrace::trace_unsynchronized<backtrace::capture::impl$4::create::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\backtrace\mod.rs:66
   1: backtrace::backtrace::trace<backtrace::capture::impl$4::create::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\backtrace\mod.rs:53
   2: backtrace::capture::Backtrace::create
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\capture.rs:294
   3: backtrace::capture::Backtrace::new_unresolved
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\capture.rs:289
   4: soroban_env_host::host::error::impl$10::maybe_get_debug_info::closure$0
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:293
   5: soroban_env_host::budget::Budget::with_shadow_mode<tuple$<>,soroban_env_host::host::error::impl$10::maybe_get_debug_info::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\budget.rs:972
   6: soroban_env_host::host::Host::with_debug_mode<soroban_env_host::host::error::impl$10::maybe_get_debug_info::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:615
   7: soroban_env_host::host::Host::maybe_get_debug_info
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:290
   8: soroban_env_host::host::error::impl$10::error::closure$0
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:274
   9: soroban_env_host::budget::Budget::with_shadow_mode<tuple$<>,soroban_env_host::host::error::impl$10::error::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\budget.rs:972
  10: soroban_env_host::host::Host::with_debug_mode<soroban_env_host::host::error::impl$10::error::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:615
  11: soroban_env_host::host::Host::error
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:261
  12: soroban_env_host::host::impl$4::escalate_error_to_panic
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:767
  13: soroban_sdk::env::internal::reject_err::closure$0<soroban_env_common::val::Val>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:52
  14: enum2$<core::result::Result<soroban_env_common::val::Val,soroban_env_host::host::error::HostError> >::map_err<soroban_env_common::val::Val,soroban_env_host::host::error::HostError,enum2$<core::convert::Infallible>,soroban_sdk::env::internal::reject_err::cl
             at /rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\library\core\src\result.rs:968
  15: soroban_sdk::env::internal::reject_err<soroban_env_common::val::Val>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:52
  16: soroban_sdk::env::impl$20::call
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:1667
  17: soroban_sdk::env::Env::invoke_contract<u64>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:379
  18: petchain_stellar::PetChainContractClient::add_vaccination
             at src\lib.rs:402
  19: petchain_stellar::test::test::test_vaccination_history_overdue
             at src\test.rs:270
  20: petchain_stellar::test::test::test_vaccination_history_overdue::closure$0
             at src\test.rs:244
  21: core::ops::function::FnOnce::call_once<petchain_stellar::test::test::test_vaccination_history_overdue::closure_env$0,tuple$<> >
             at /rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\library\core\src\ops\function.rs:250


Writing test snapshot file for test "test::test::test_vaccination_history_overdue" to "test_snapshots\\test\\test\\test_vaccination_history_overdue.1.json".

---- test::test::test_record_and_get_vaccination stdout ----

thread 'test::test::test_record_and_get_vaccination' (34204) panicked at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:768:9:
HostError: Error(WasmVm, InvalidAction)

Event log (newest first):
   0: [Diagnostic Event] topics:[error, Error(WasmVm, InvalidAction)], data:"escalating error to panic"
   1: [Diagnostic Event] topics:[error, Error(WasmVm, InvalidAction)], data:["contract call failed", add_vaccination, [1, CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCT4, [Rabies], "Rabies Vaccine", 0, 1000, "BATCH-001"]]
   2: [Failed Diagnostic Event (not emitted)] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:[error, Error(WasmVm, InvalidAction)], data:"caught error from function"
   3: [Failed Diagnostic Event (not emitted)] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:[log], data:["caught panic 'Veterinarian not verified' from contract function 'Symbol(obj#147)'", 1, CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCT4, [Rabies], "Rabies Vaccine", 0, 1000, "BATCH-001"]
   4: [Diagnostic Event] topics:[fn_call, Bytes(0000000000000000000000000000000000000000000000000000000000000001), add_vaccination], data:[1, CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCT4, [Rabies], "Rabies Vaccine", 0, 1000, "BATCH-001"]
   5: [Diagnostic Event] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:[fn_return, register_pet], data:1
   6: [Contract Event] contract:CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2KM, topics:["PetRegistered", 1], data:{name: "PROTECTED", owner: CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHK3M, pet_id: 1, species: [Dog], timestamp: 0}
   7: [Diagnostic Event] topics:[fn_call, Bytes(0000000000000000000000000000000000000000000000000000000000000001), register_pet], data:[CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHK3M, "Buddy", "2020-01-01", [Male], [Dog], "Retriever", [Public]]

Backtrace (newest first):
   0: backtrace::backtrace::win64::trace
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\backtrace\win64.rs:85
      backtrace::backtrace::trace_unsynchronized<backtrace::capture::impl$4::create::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\backtrace\mod.rs:66
   1: backtrace::backtrace::trace<backtrace::capture::impl$4::create::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\backtrace\mod.rs:53
   2: backtrace::capture::Backtrace::create
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\capture.rs:294
   3: backtrace::capture::Backtrace::new_unresolved
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\backtrace-0.3.76\src\capture.rs:289
   4: soroban_env_host::host::error::impl$10::maybe_get_debug_info::closure$0
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:293
   5: soroban_env_host::budget::Budget::with_shadow_mode<tuple$<>,soroban_env_host::host::error::impl$10::maybe_get_debug_info::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\budget.rs:972
   6: soroban_env_host::host::Host::with_debug_mode<soroban_env_host::host::error::impl$10::maybe_get_debug_info::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:615
   7: soroban_env_host::host::Host::maybe_get_debug_info
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:290
   8: soroban_env_host::host::error::impl$10::error::closure$0
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:274
   9: soroban_env_host::budget::Budget::with_shadow_mode<tuple$<>,soroban_env_host::host::error::impl$10::error::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\budget.rs:972
  10: soroban_env_host::host::Host::with_debug_mode<soroban_env_host::host::error::impl$10::error::closure_env$0>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:615
  11: soroban_env_host::host::Host::error
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host\error.rs:261
  12: soroban_env_host::host::impl$4::escalate_error_to_panic
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-env-host-21.2.1\src\host.rs:767
  13: soroban_sdk::env::internal::reject_err::closure$0<soroban_env_common::val::Val>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:52
  14: enum2$<core::result::Result<soroban_env_common::val::Val,soroban_env_host::host::error::HostError> >::map_err<soroban_env_common::val::Val,soroban_env_host::host::error::HostError,enum2$<core::convert::Infallible>,soroban_sdk::env::internal::reject_err::cl
             at /rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\library\core\src\result.rs:968
  15: soroban_sdk::env::internal::reject_err<soroban_env_common::val::Val>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:52
  16: soroban_sdk::env::impl$20::call
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:1667
  17: soroban_sdk::env::Env::invoke_contract<u64>
             at C:\Users\nwaug\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\soroban-sdk-21.7.7\src\env.rs:379
  18: petchain_stellar::PetChainContractClient::add_vaccination
             at src\lib.rs:402
  19: petchain_stellar::test::test::test_record_and_get_vaccination
             at src\test.rs:82
  20: petchain_stellar::test::test::test_record_and_get_vaccination::closure$0
             at src\test.rs:60
  21: core::ops::function::FnOnce::call_once<petchain_stellar::test::test::test_record_and_get_vaccination::closure_env$0,tuple$<> >
             at /rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\library\core\src\ops\function.rs:250


note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
Writing test snapshot file for test "test::test::test_record_and_get_vaccination" to "test_snapshots\\test\\test\\test_record_and_get_vaccination.1.json".


failures:
    test::test::test_record_and_get_vaccination
    test::test::test_vaccination_history_overdue

test result: FAILED. 10 passed; 2 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.89s

error: test failed, to rerun pass `--lib`
